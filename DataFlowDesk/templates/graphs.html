{% extends 'base.html' %}

{% block content %}
<div class="container mx-auto px-6 py-8">
    <h1 class="text-4xl font-semibold text-gray-900 mb-8">Data Visualizations</h1>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- Load Chart.js here -->

    {% for chart in charts %}
    <div class="bg-white shadow-lg rounded-lg p-6 mb-8 max-w-4xl mx-auto">
        <h3 class="text-2xl font-medium text-gray-800 mb-4">{{ chart.title }}</h3>

        <div class="relative">
            <canvas id="chart{{ forloop.counter }}" class="w-full h-96"></canvas>
        </div>

        <script id="chart-data-{{ forloop.counter }}" type="application/json">
            {{ chart.data|safe }}
        </script>

        <script>
            try {
                var chartData = JSON.parse(document.getElementById('chart-data-{{ forloop.counter }}').textContent);
                var ctx = document.getElementById('chart{{ forloop.counter }}').getContext('2d');
                var chart = new Chart(ctx, {
                    type: '{{ chart.type }}',
                    data: chartData,
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'top',
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                            },
                        },
                        // Optionally, you can add more configuration options for different chart types here.
                    },
                });
            } catch (error) {
                console.error("Error parsing or rendering chart data for chart{{ forloop.counter }}:", error);
            }
        </script>
    </div>
    {% endfor %}
</div>
{% endblock %}
